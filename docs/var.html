<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>13 VAR | Time Series Analysis With R</title>
<meta name="author" content="Nicola Righetti">
<meta name="generator" content="bookdown 0.43 with bs4_book()">
<meta property="og:title" content="13 VAR | Time Series Analysis With R">
<meta property="og:type" content="book">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="13 VAR | Time Series Analysis With R">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.8.0/transition.js"></script><script src="libs/bs3compat-0.8.0/tabs.js"></script><script src="libs/bs3compat-0.8.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
<meta name="description" content="VAR is an acronym that stands for Vector Autoregressive Model. It is a common method for the analysis of multivariate time series. It can be conceived as a way to model a system of time series. In...">
<meta property="og:description" content="VAR is an acronym that stands for Vector Autoregressive Model. It is a common method for the analysis of multivariate time series. It can be conceived as a way to model a system of time series. In...">
<meta name="twitter:description" content="VAR is an acronym that stands for Vector Autoregressive Model. It is a common method for the analysis of multivariate time series. It can be conceived as a way to model a system of time series. In...">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Time Series Analysis With R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Time Series Analysis With R</a></li>
<li><a class="" href="getting-started-with-r.html"><span class="header-section-number">2</span> Getting started with R</a></li>
<li><a class="" href="getting-started-with-r-1.html"><span class="header-section-number">3</span> Getting started with R</a></li>
<li><a class="" href="basic-data-wrangling-with-tidyverse.html"><span class="header-section-number">4</span> Basic Data Wrangling with Tidyverse</a></li>
<li><a class="" href="basic-concepts.html"><span class="header-section-number">5</span> Basic Concepts</a></li>
<li><a class="" href="time-series-objects.html"><span class="header-section-number">6</span> Time Series Objects</a></li>
<li><a class="" href="plot-time-series.html"><span class="header-section-number">7</span> Plot Time Series</a></li>
<li><a class="" href="structural-decomposition.html"><span class="header-section-number">8</span> Structural Decomposition</a></li>
<li><a class="" href="correlations-and-arima.html"><span class="header-section-number">9</span> Correlations and ARIMA</a></li>
<li><a class="" href="regression.html"><span class="header-section-number">10</span> Regression</a></li>
<li><a class="" href="intervention-analysis.html"><span class="header-section-number">11</span> Intervention Analysis</a></li>
<li><a class="" href="interrupted-time-series-analysis-using-segmented-regression.html"><span class="header-section-number">12</span> Interrupted time series analysis using segmented regression</a></li>
<li><a class="active" href="var.html"><span class="header-section-number">13</span> VAR</a></li>
<li><a class="" href="readings-and-bibliographical-references.html"><span class="header-section-number">14</span> Readings and Bibliographical References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="var" class="section level1" number="13">
<h1>
<span class="header-section-number">13</span> VAR<a class="anchor" aria-label="anchor" href="#var"><i class="fas fa-link"></i></a>
</h1>
<p><em>VAR</em> is an acronym that stands for <strong>Vector Autoregressive Model</strong>. It is a common method for the analysis of multivariate time series.</p>
<p>It can be conceived as a way to model a <strong>system</strong> of time series. In a VAR model, there is no rigid distinction between independent and dependent variables, but each variable is both dependent and independent. Besides these <strong>endogenous</strong> variables that dynamically interact, a VAR model can include <strong>exogenous</strong> variables. Exogenous variables can have an impact on the endogenous variables, while the opposite is not true. To make a simple example, the time series of fans sold by month may be influenced by the quantity of fans produced and distributed by the industry, and by the monthly temperature. While the purchase and production of fans can interact (endogenous variables), the weather is not impacted by these processes, but just impact them as an external force (exogenous variable).</p>
<p>To make another example (from the paper <a href="http://www.italiansociologicalreview.com/ojs/index.php?journal=ISR&amp;page=article&amp;op=view&amp;path%5B%5D=448&amp;path%5B%5D=346">The Impact of the Politicization of Health on Online Misinformation and Quality Information on Vaccines</a>), the political debate on a certain topic - for instance the political debate that led to the promulgation of the law on mandatory vaccinations in Italy - could be considered an exogenous variable that impacts both the news coverage of the topic and the spread of problematic information on Twitter. While news media coverage and Twitter discussions can be considered part of the same communication system and dependent on each other (news media could set the discussion agenda on Twitter, but also social media can stimulate news media coverage) it could be assumed that the political debate that led to the promulgation of the law on mandatory vaccinations was independent from the Twitter discussions on the topic.</p>
<p>Stationary tests are usually applied to ascertain that variables are not integrated (the “I” in the ARIMA model). If this is the case, variables are differenced before starting the VAR analysis. Other preliminary analysis (for instance testing for <em>cointegration</em>) and pre-processing can be performed before the analysis. Next, the number of lags to be used has to be selected. This number can be automatically identify through automated methods (lag-length selection criteria methods). The model is then evaluated. Results from a VAR model are usually complicated, and the researchers relies on statistical methods such as <em>Granger causality test</em>. <a href="https://en.wikipedia.org/wiki/Granger_causality"><em>Granger causality test</em></a>, a test developed by the nobel prize winner Clive Granger, has been applied to study agenda setting processes. A variable <span class="math inline">\(X\)</span> is said to <strong>“Granger cause”</strong> another variable <span class="math inline">\(Y\)</span> if <span class="math inline">\(Y\)</span> can be better predicted from the past values of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> together than from the past of <span class="math inline">\(Y\)</span> alone.</p>
<blockquote>
<p>The Granger causality test is a statistical hypothesis test for determining whether one time series is useful in forecasting another, first proposed in 1969. Ordinarily, regressions reflect “mere” correlations, but Clive Granger argued that causality (…) could be tested for by measuring the ability to predict the future values of a time series using prior values of another time series. Since the question of “true causality” is deeply philosophical, and because of the post hoc ergo propter hoc fallacy of assuming that one thing preceding another can be used as a proof of causation, (…) the Granger test finds only “predictive causality”.</p>
</blockquote>
<p>An R package to perform VAR modeling is <a href="https://cran.r-project.org/web/packages/vars/vars.pdf"><strong>vars</strong></a>.</p>
<p>Practical applications of VAR modeling, including Granger causality, can be found, for instance, in the paper <a href="https://academic.oup.com/joc/article-abstract/71/2/305/6104044">Assembling the Networks and Audiences of Disinformation: How Successful Russian IRA Twitter Accounts Built Their Followings,2015–2017</a> or
<a href="https://www-tandfonline-com.uaccess.univie.ac.at/doi/full/10.1080/10584609.2019.1661889">Coordinating a Multi-Platform Disinformation Campaign: Internet Research Agency Activity on Three U.S. Social Media Platforms, 2015 to 2017</a> <a href="https://github.com/jlukito/timeseries-bootcamp/blob/master/3_multivariate/varmodeling.md">at this link</a>.</p>
<div id="var-modeling-hands-on-tutorial" class="section level2" number="13.1">
<h2>
<span class="header-section-number">13.1</span> VAR modeling hands-on tutorial<a class="anchor" aria-label="anchor" href="#var-modeling-hands-on-tutorial"><i class="fas fa-link"></i></a>
</h2>
<div id="assumption-of-stationarity" class="section level3" number="13.1.1">
<h3>
<span class="header-section-number">13.1.1</span> Assumption of stationarity<a class="anchor" aria-label="anchor" href="#assumption-of-stationarity"><i class="fas fa-link"></i></a>
</h3>
<p>Like most time series techniques, VAR assumes the series to be <strong>stationary</strong>. To recap:</p>
<blockquote>
<p>A stationary time series is one whose properties do not depend on the time at which the series is observed. Thus, time series with trends, or with seasonality, are not stationary — the trend and seasonality will affect the value of the time series at different times. On the other hand, a white noise series is stationary — it does not matter when you observe it, it should look much the same at any point in time. […] In general, a stationary time series will have no predictable patterns in the long-term. Time plots will show the series to be roughly horizontal (although some cyclic behaviour is possible), with constant variance. <a href="https://otexts.com/fpp2/stationarity.html">Rob J. Hyndman and George Athanasopoulos, “Forecasting: Principles and Practice”</a>.</p>
</blockquote>
<p>Below are some examples of stationary and non-stationary series.</p>
<div class="sourceCode" id="cb353"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/layout.html">layout</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">3</span>, byrow <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">wn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">1000</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">wn</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Stationary Time Series (White Noise)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">nonvariance_stat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">1000</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1</span><span class="op">:</span><span class="fl">1000</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">nonvariance_stat</span><span class="op">)</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"Non stationary in variance"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">linear_trend</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">1000</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.05</span><span class="op">*</span><span class="fl">1</span><span class="op">:</span><span class="fl">1000</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">linear_trend</span><span class="op">)</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"Non stationary in mean (Linear Trend)"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">seasonality</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">24</span><span class="op">*</span><span class="fl">30</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">24</span>, <span class="fl">30</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">seasonality</span><span class="op">)</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"Non stationary in mean (Seasonality)"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">random_walk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">100</span>, <span class="fl">100</span><span class="op">)</span>, <span class="fl">1000</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1000</span>, sd <span class="op">=</span> <span class="fl">44</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">random_walk</span><span class="op">)</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"Non stationary in mean (Random Walk)"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Time-Series-Analysis-With-R_files/figure-html/unnamed-chunk-227-1.png" width="672"></div>
<p>As we already learnt, <strong>some pre-processing steps are usually carried out to make it stationary</strong> when the series is not stationary. For instance, a series with a linear trend can be made stationary by removing the trend. A seasonal series can be seasonally adjusted. A random-walk-like series can be adjusted using differencing. Visual inspection and <strong>statistical tests</strong> can be performed to support findings on the characteristics of a time series.</p>
<p>Some of these pre-processing steps may be unnecessary when using the <strong>vars</strong> library, because its function <strong>VAR</strong> (which is used to fit VAR models) allows you to include trend and seasonality components.</p>
<div class="sourceCode" id="cb354"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/layout.html">layout</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">7</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">4</span>, byrow <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">wn</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Stationary Time Series (White Noise)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">random_walk</span><span class="op">)</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"Non stationary in mean (Random Walk)"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">random_walk</span><span class="op">)</span><span class="op">)</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"Differenced"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">linear_trend</span><span class="op">)</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"Non stationary in mean (Linear Trend)"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">linear_trend</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">linear_trend</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"Detrended"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">seasonality</span><span class="op">)</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"Non stationary in mean (Seasonality)"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">decomposed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/decompose.html">decompose</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">seasonality</span>, frequency <span class="op">=</span> <span class="fl">24</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">deseasonalized</span> <span class="op">&lt;-</span> <span class="va">seasonality</span> <span class="op">-</span> <span class="va">decomposed</span><span class="op">$</span><span class="va">seasonal</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">deseasonalized</span><span class="op">)</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"Deseasonalized"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Time-Series-Analysis-With-R_files/figure-html/unnamed-chunk-228-1.png" width="672"></div>
</div>
<div id="other-assumptions-of-var-models-distribution-of-residuals" class="section level3" number="13.1.2">
<h3>
<span class="header-section-number">13.1.2</span> Other assumptions of VAR models: distribution of residuals<a class="anchor" aria-label="anchor" href="#other-assumptions-of-var-models-distribution-of-residuals"><i class="fas fa-link"></i></a>
</h3>
<p>Besides <strong>stationarity</strong> and <strong>linearity</strong> between variables and their lagged values, VAR cannot be performed in the presence of <strong>structural breaks</strong>. Structural breaks are abrupt changes in the series’ mean or overall process. You can deal with structural breaks in different ways. For example, you might want to split the series into different phases, using the structural breaks as breakpoints.</p>
<p>Other crucial assumptions of VAR are about <strong>residuals</strong>, which are required to be:</p>
<ul>
<li>Non serially correlated</li>
<li>Normal distributed</li>
<li>Homoskedastic</li>
</ul>
<p>Statistical tests included in the <em>vars</em> package can be used to check these assumptions.</p>
<p>Another fundamental assumption of VAR models is the <strong>absence of cointegration</strong> between series. Two series may be cointegrated only when they are both <strong>integrated of the same order</strong>. Integrated series achieve stationarity after being differentiated. The number of differentiation needed to achieve stationarity is the <strong>order of integration</strong> (usually, it is one: <em>I(1)</em> is the notation).</p>
<p>Integrated series are non-stationary, but it can happen that <strong>there is a linear combination of integrated series that is stationary. In that case, they are said to be cointegrated</strong>. Although each series follows a seemingly random path, over time, they are characterized by an equilibrium, as if they were driven by a common underlying process. Cointegration has been explained with the help of the story of the <strong>drunk and his dog</strong>:</p>
<blockquote>
<p>In fact, the drunk is not the only creature whose behavior follow a random walk. Puppies, too, wander aimlessly when unleashed. Each new scent that crosses the puppy’s nose dictates a direction for the pup’s next step. […] But what if the dog belongs to the drunk? The drunk sets out from the bar, about to wander aimlessly in random-walk fashion. But periodically she intones “Oliver, where are you?”, and Oliver interrupts his aimless wandering to bark. He hears her; she hears him. He thinks: “Oh I can’t let her get too far off; she’ll lock me out”. She thinks, “Oh, I can’t let him get too far off; he’ll wake me up in the middle of the night with his barking”. Each assessed how far away the other is and moves to partially close that gap. Now neither drunk nor dog follows a random walk; each has added what we formally call an error-correction-mechanism to her or his steps. […] The paths of the drunk and the dog are still non-stationary. Significantly, despite the nonstationarity of the paths, one might still say, “If you find her, the dog is unlikely to be very far away”. If this is right, then the distance between the two paths is stationary, and the walks of the woman and her dog are said to be cointegrated (…). […] Notice that cointegration is a probabilistic concept. The dog is not on a leash, which would enforce a fixed distance between the drunk and the dog. The distance between the drunk and the dog is instead a random variable. But a stationary one, despite the nonstationarity of the two paths. <a href="http://www-stat.wharton.upenn.edu/~steele/Courses/434F2005/Context/Co-integration/Murray93DrunkAndDog.pdf">Murray, M. P. (1994). A drunk and her dog: an illustration of cointegration and error correction. The American Statistician, 48(1), 37-39.</a></p>
</blockquote>
<p>Statistical tests are used to determine whether cointegration is present. They have to be performed only when the series are integrated and have the same order of integration (again, cointegration can only exists if at least two series are integrated of the same order). Then, <em>cointegration tests</em> are performed. In presence of cointegration, <strong>Vector Error Correction Models (VECM)</strong> are used instead of VAR. VECM is basically a VAR model with an “error correction term”. This topic is not (yet) covered in this tutorial.</p>
</div>
</div>
<div id="var-fitting" class="section level2" number="13.2">
<h2>
<span class="header-section-number">13.2</span> VAR fitting<a class="anchor" aria-label="anchor" href="#var-fitting"><i class="fas fa-link"></i></a>
</h2>
<p>Let’s make a simple example.
Upload some data:</p>
<pre><code>##             date_time anti   pro
## 1 2021-03-12 23:59:00   37 14085
## 2 2021-03-13 23:59:00  157  5219
## 3 2021-03-14 23:59:00   40  5106
## 4 2021-03-15 23:59:00   25  6898
## 5 2021-03-16 23:59:00   24  2974
## 6 2021-03-17 23:59:00   61  3230</code></pre>
<p>Let’s visually inspect the series:</p>
<div class="sourceCode" id="cb356"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html">plot.ts</a></span><span class="op">(</span><span class="va">ts_tweets</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pro"</span>, <span class="st">"anti"</span><span class="op">)</span><span class="op">]</span>, </span>
<span>        plot.type <span class="op">=</span> <span class="st">"multiple"</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"tweets"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Time-Series-Analysis-With-R_files/figure-html/unnamed-chunk-230-1.png" width="672"></div>
<p>As the variance does not look constant, so we can tentatively <strong>log-transform the series</strong> and work with log-transformed data.</p>
<div class="sourceCode" id="cb357"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ts_tweets</span><span class="op">$</span><span class="va">pro</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">ts_tweets</span><span class="op">$</span><span class="va">pro</span><span class="op">)</span></span>
<span><span class="va">ts_tweets</span><span class="op">$</span><span class="va">anti</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">ts_tweets</span><span class="op">$</span><span class="va">anti</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html">plot.ts</a></span><span class="op">(</span><span class="va">ts_tweets</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pro"</span>, <span class="st">"anti"</span><span class="op">)</span><span class="op">]</span>, </span>
<span>        plot.type <span class="op">=</span> <span class="st">"multiple"</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"tweets"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Time-Series-Analysis-With-R_files/figure-html/unnamed-chunk-231-1.png" width="672"></div>
<p>To check for stationarity, we can perform a test such as the Augmented Dickey-Fuller Test. Integration is suggested only for the “anti” series.</p>
<div class="sourceCode" id="cb358"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tseries</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tseries/man/adf.test.html">adf.test</a></span><span class="op">(</span><span class="va">ts_tweets</span><span class="op">$</span><span class="va">pro</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Augmented Dickey-Fuller Test
## 
## data:  ts_tweets$pro
## Dickey-Fuller = -3.9314, Lag order = 3, p-value = 0.02193
## alternative hypothesis: stationary</code></pre>
<div class="sourceCode" id="cb360"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tseries</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tseries/man/adf.test.html">adf.test</a></span><span class="op">(</span><span class="va">ts_tweets</span><span class="op">$</span><span class="va">anti</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Augmented Dickey-Fuller Test
## 
## data:  ts_tweets$anti
## Dickey-Fuller = -2.101, Lag order = 3, p-value = 0.5338
## alternative hypothesis: stationary</code></pre>
<p>The series becomes stationary after differencing.</p>
<div class="sourceCode" id="cb362"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">anti</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">ts_tweets</span><span class="op">$</span><span class="va">anti</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu">tseries</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tseries/man/adf.test.html">adf.test</a></span><span class="op">(</span><span class="va">anti</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning in tseries::adf.test(anti): p-value smaller than printed p-value</code></pre>
<pre><code>## 
##  Augmented Dickey-Fuller Test
## 
## data:  anti
## Dickey-Fuller = -4.7232, Lag order = 3, p-value = 0.01
## alternative hypothesis: stationary</code></pre>
<p>We can recreate the dataset including the differentiated series. Using a first difference transformation, we lose the first data point.</p>
<div class="sourceCode" id="cb365"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">anti</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 41</code></pre>
<div class="sourceCode" id="cb367"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">ts_tweets</span><span class="op">$</span><span class="va">pro</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 42</code></pre>
<p>Indeed, the first point in the differentiated series is obtained by subtracting the first point from the second one. The second point in the differentiated series is obtained by subtracting the second point from the third one, and so on. Hence, the differentiated dataset will start from the second point in time, not the first one as in the original series. Therefore, we need to drop the first data point from the dataset.</p>
<div class="sourceCode" id="cb369"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># drop the first data point</span></span>
<span><span class="va">ts_tweets</span> <span class="op">&lt;-</span> <span class="va">ts_tweets</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>,<span class="op">]</span></span>
<span></span>
<span><span class="co"># replance the anti series with the differentiated anti series</span></span>
<span><span class="va">ts_tweets</span><span class="op">$</span><span class="va">anti</span> <span class="op">&lt;-</span> <span class="va">anti</span></span></code></pre></div>
<p>To fit the VAR model we use the library <strong>vars</strong>.</p>
<div class="sourceCode" id="cb370"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("vars")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.pfaffikus.de">vars</a></span><span class="op">)</span></span></code></pre></div>
<pre><code>## Loading required package: MASS</code></pre>
<pre><code>## 
## Attaching package: 'MASS'</code></pre>
<pre><code>## The following object is masked from 'package:dplyr':
## 
##     select</code></pre>
<pre><code>## Loading required package: strucchange</code></pre>
<pre><code>## Loading required package: sandwich</code></pre>
<pre><code>## 
## Attaching package: 'strucchange'</code></pre>
<pre><code>## The following object is masked from 'package:stringr':
## 
##     boundary</code></pre>
<pre><code>## Loading required package: urca</code></pre>
<p>VAR models require the researcher to specify the number of lags to include in the model. Roughly speaking, lags are auto-regressive predictors. For example, considering a VAR model with two variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, using 1 lag means that we use the value <span class="math inline">\(X_{t-1}\)</span> and <span class="math inline">\(Y_{t-1}\)</span> to predict <span class="math inline">\(X_t\)</span> and <span class="math inline">\(Y_t\)</span>, and 2 lags that we use <span class="math inline">\(X_{t-1}\)</span>, <span class="math inline">\(X_{t-2}\)</span>, <span class="math inline">\(Y_{t-1}\)</span>, and <span class="math inline">\(Y_{t-2}\)</span>. The choice of lags is important. The function <strong>VARselect</strong> implements four different statistical tests to find the “best” number of lags.</p>
<p>In this case, all the criteria agree on one lag.</p>
<div class="sourceCode" id="cb379"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">vars</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/vars/man/VARselect.html">VARselect</a></span><span class="op">(</span><span class="va">ts_tweets</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pro"</span>, <span class="st">"anti"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code>## $selection
## AIC(n)  HQ(n)  SC(n) FPE(n) 
##      1      1      1      1 
## 
## $criteria
##                  1           2           3           4          5           6           7
## AIC(n) -2.92630038 -2.81403228 -2.64199556 -2.42923055 -2.5769659 -2.77801920 -2.68597480
## HQ(n)  -2.83582733 -2.66324387 -2.43089178 -2.15781141 -2.2452314 -2.38596933 -2.23360957
## SC(n)  -2.64875447 -2.35145577 -1.99438843 -1.59659281 -1.5592975 -1.57532025 -1.29824525
## FPE(n)  0.05366012  0.06030449  0.07235601  0.09118664  0.0810697  0.06940455  0.08132081
##                  8          9         10
## AIC(n) -2.68018280 -2.5499629 -2.4424493
## HQ(n)  -2.16750221 -1.9769669 -1.8091380
## SC(n)  -1.10742264 -0.7921721 -0.4996280
## FPE(n)  0.08986526  0.1167941  0.1564827</code></pre>
<p>The function to fit the model is <strong>VAR</strong>, and the number of lags is specified using the <em>p</em> parameter.</p>
<p>You can also include <strong>trend</strong> and/or <strong>seasonality</strong>, but in this case it doesn’t seem useful. It is also possible to include <strong>exogenous variables</strong>. Exogenous variables are usually defined as variables external to the system: they may affect the system, but are not affected by the system.</p>
<p>As in the VARselect function, we only use the columns containing the data (the first column in the dataset contains dates).</p>
<div class="sourceCode" id="cb381"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">var_fit</span> <span class="op">&lt;-</span> <span class="fu">vars</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/vars/man/VAR.html">VAR</a></span><span class="op">(</span><span class="va">ts_tweets</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pro"</span>, <span class="st">"anti"</span><span class="op">)</span><span class="op">]</span>, p <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>The model looks like this. As you can see, it is a system of linear regression models that includes lagged predictors. Before analyzing the results we need to confirm that the assumptions of the models are met.</p>
<div class="sourceCode" id="cb382"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/urca/man/summary-methods.html">summary</a></span><span class="op">(</span><span class="va">var_fit</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## VAR Estimation Results:
## ========================= 
## Endogenous variables: pro, anti 
## Deterministic variables: const 
## Sample size: 40 
## Log Likelihood: -53.79 
## Roots of the characteristic polynomial:
## 0.4477 0.2503
## Call:
## vars::VAR(y = ts_tweets[, c("pro", "anti")], p = 1)
## 
## 
## Estimation results for equation pro: 
## ==================================== 
## pro = pro.l1 + anti.l1 + const 
## 
##         Estimate Std. Error t value Pr(&gt;|t|)    
## pro.l1   0.25131    0.16894   1.488    0.145    
## anti.l1 -0.05992    0.06722  -0.891    0.379    
## const    6.27985    1.41950   4.424 8.22e-05 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## 
## Residual standard error: 0.3364 on 37 degrees of freedom
## Multiple R-Squared: 0.06146, Adjusted R-squared: 0.01073 
## F-statistic: 1.212 on 2 and 37 DF,  p-value: 0.3093 
## 
## 
## Estimation results for equation anti: 
## ===================================== 
## anti = pro.l1 + anti.l1 + const 
## 
##         Estimate Std. Error t value Pr(&gt;|t|)   
## pro.l1   0.01161    0.38475   0.030  0.97610   
## anti.l1 -0.44871    0.15309  -2.931  0.00576 **
## const   -0.10750    3.23284  -0.033  0.97365   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## 
## Residual standard error: 0.7661 on 37 degrees of freedom
## Multiple R-Squared: 0.2029,  Adjusted R-squared: 0.1598 
## F-statistic: 4.709 on 2 and 37 DF,  p-value: 0.01507 
## 
## 
## 
## Covariance matrix of residuals:
##         pro   anti
## pro  0.1132 0.0862
## anti 0.0862 0.5870
## 
## Correlation matrix of residuals:
##         pro   anti
## pro  1.0000 0.3345
## anti 0.3345 1.0000</code></pre>
<p><em>serial.test</em> is a test for serially correlated errors. The test is okay when not significant. The test is not significant.</p>
<div class="sourceCode" id="cb384"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">vars</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/vars/man/serial.html">serial.test</a></span><span class="op">(</span><span class="va">var_fit</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Portmanteau Test (asymptotic)
## 
## data:  Residuals of VAR object var_fit
## Chi-squared = 33.632, df = 60, p-value = 0.9977</code></pre>
<p><em>normality.test</em> performs tests for the normality of residuals. The tests are okay when not significant, like in this case.</p>
<div class="sourceCode" id="cb386"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">vars</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/vars/man/normality.html">normality.test</a></span><span class="op">(</span><span class="va">var_fit</span><span class="op">)</span></span></code></pre></div>
<pre><code>## $JB
## 
##  JB-Test (multivariate)
## 
## data:  Residuals of VAR object var_fit
## Chi-squared = 3.9951, df = 4, p-value = 0.4067
## 
## 
## $Skewness
## 
##  Skewness only (multivariate)
## 
## data:  Residuals of VAR object var_fit
## Chi-squared = 1.8704, df = 2, p-value = 0.3925
## 
## 
## $Kurtosis
## 
##  Kurtosis only (multivariate)
## 
## data:  Residuals of VAR object var_fit
## Chi-squared = 2.1247, df = 2, p-value = 0.3456</code></pre>
<p>Another fundamental test is performed by the function <em>stability</em>. The test is okay if the series stay within the red bars. It is okay.</p>
<div class="sourceCode" id="cb388"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="fu">vars</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/vars/man/stability.html">stability</a></span><span class="op">(</span><span class="va">var_fit</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Time-Series-Analysis-With-R_files/figure-html/unnamed-chunk-242-1.png" width="672"></div>
<p><em>arch.test</em> assesses the null hypothesis that a series of residuals exhibits no heteroscedasticity. Also this test is not significant, which is good.</p>
<div class="sourceCode" id="cb389"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">vars</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/vars/man/arch.html">arch.test</a></span><span class="op">(</span><span class="va">var_fit</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  ARCH (multivariate)
## 
## data:  Residuals of VAR object var_fit
## Chi-squared = 44.188, df = 45, p-value = 0.5062</code></pre>
<p>As all the assumptions are met, we can take a look at the overall fit. It doesn’t look amazing, but the assumptions are met, so let’s assume it is good enough and let’s go ahead with the analysis.</p>
<div class="sourceCode" id="cb391"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">var_fit</span><span class="op">)</span></span></code></pre></div>
<p><img src="Time-Series-Analysis-With-R_files/figure-html/unnamed-chunk-244-1.png" width="480"><img src="Time-Series-Analysis-With-R_files/figure-html/unnamed-chunk-244-2.png" width="480"></p>
<p>The not-so-good fit is probably related to the fact that both variables in the VAR system are not highly correlated. Most coefficients are not statistically significant and the overall R-square is small.</p>
<p>Generally, the coefficient table is not interpreted. Instead, VAR models are interpreted using other tools, such as the Granger causality test.</p>
<div class="sourceCode" id="cb392"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/urca/man/summary-methods.html">summary</a></span><span class="op">(</span><span class="va">var_fit</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## VAR Estimation Results:
## ========================= 
## Endogenous variables: pro, anti 
## Deterministic variables: const 
## Sample size: 40 
## Log Likelihood: -53.79 
## Roots of the characteristic polynomial:
## 0.4477 0.2503
## Call:
## vars::VAR(y = ts_tweets[, c("pro", "anti")], p = 1)
## 
## 
## Estimation results for equation pro: 
## ==================================== 
## pro = pro.l1 + anti.l1 + const 
## 
##         Estimate Std. Error t value Pr(&gt;|t|)    
## pro.l1   0.25131    0.16894   1.488    0.145    
## anti.l1 -0.05992    0.06722  -0.891    0.379    
## const    6.27985    1.41950   4.424 8.22e-05 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## 
## Residual standard error: 0.3364 on 37 degrees of freedom
## Multiple R-Squared: 0.06146, Adjusted R-squared: 0.01073 
## F-statistic: 1.212 on 2 and 37 DF,  p-value: 0.3093 
## 
## 
## Estimation results for equation anti: 
## ===================================== 
## anti = pro.l1 + anti.l1 + const 
## 
##         Estimate Std. Error t value Pr(&gt;|t|)   
## pro.l1   0.01161    0.38475   0.030  0.97610   
## anti.l1 -0.44871    0.15309  -2.931  0.00576 **
## const   -0.10750    3.23284  -0.033  0.97365   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## 
## Residual standard error: 0.7661 on 37 degrees of freedom
## Multiple R-Squared: 0.2029,  Adjusted R-squared: 0.1598 
## F-statistic: 4.709 on 2 and 37 DF,  p-value: 0.01507 
## 
## 
## 
## Covariance matrix of residuals:
##         pro   anti
## pro  0.1132 0.0862
## anti 0.0862 0.5870
## 
## Correlation matrix of residuals:
##         pro   anti
## pro  1.0000 0.3345
## anti 0.3345 1.0000</code></pre>
</div>
<div id="granger-causality-test" class="section level2" number="13.3">
<h2>
<span class="header-section-number">13.3</span> Granger causality test<a class="anchor" aria-label="anchor" href="#granger-causality-test"><i class="fas fa-link"></i></a>
</h2>
<p>We use the <strong>causality</strong> function to perform the Granger causality test. The Granger causality test is the most basic inferential tool available in VAR analysis. A time series X is considered a Granger cause of another time series Y if past values of X and Y predicts Y significantly better than past values of Y alone. This analysis is frequently performed in <a href="https://scholar.google.com/scholar?hl=en&amp;as_sdt=0%2C5&amp;q=%28%22granger+causality+test%22+OR+%22granger+test%22%29+AND+%22agenda+setting%22&amp;btnG=">communication studies focused on agenda setting phenomena</a>.</p>
<p>Let’s see if there’s Granger causality between our series. The researcher needs to specify the “cause” variable (sometimes, the researcher may have a hypothesis about that). In this case, we try both. There is no granger causality effect but some contemporaneous relationship (<em>instant causation</em>).</p>
<div class="sourceCode" id="cb394"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">vars</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/vars/man/causality.html">causality</a></span><span class="op">(</span><span class="va">var_fit</span>, cause <span class="op">=</span> <span class="st">"pro"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## $Granger
## 
##  Granger causality H0: pro do not Granger-cause anti
## 
## data:  VAR object var_fit
## F-Test = 0.00090982, df1 = 1, df2 = 74, p-value = 0.976
## 
## 
## $Instant
## 
##  H0: No instantaneous causality between: pro and anti
## 
## data:  VAR object var_fit
## Chi-squared = 4.0242, df = 1, p-value = 0.04485</code></pre>
<div class="sourceCode" id="cb396"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">vars</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/vars/man/causality.html">causality</a></span><span class="op">(</span><span class="va">var_fit</span>, cause <span class="op">=</span> <span class="st">"anti"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## $Granger
## 
##  Granger causality H0: anti do not Granger-cause pro
## 
## data:  VAR object var_fit
## F-Test = 0.79448, df1 = 1, df2 = 74, p-value = 0.3756
## 
## 
## $Instant
## 
##  H0: No instantaneous causality between: anti and pro
## 
## data:  VAR object var_fit
## Chi-squared = 4.0242, df = 1, p-value = 0.04485</code></pre>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="interrupted-time-series-analysis-using-segmented-regression.html"><span class="header-section-number">12</span> Interrupted time series analysis using segmented regression</a></div>
<div class="next"><a href="readings-and-bibliographical-references.html"><span class="header-section-number">14</span> Readings and Bibliographical References</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#var"><span class="header-section-number">13</span> VAR</a></li>
<li>
<a class="nav-link" href="#var-modeling-hands-on-tutorial"><span class="header-section-number">13.1</span> VAR modeling hands-on tutorial</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#assumption-of-stationarity"><span class="header-section-number">13.1.1</span> Assumption of stationarity</a></li>
<li><a class="nav-link" href="#other-assumptions-of-var-models-distribution-of-residuals"><span class="header-section-number">13.1.2</span> Other assumptions of VAR models: distribution of residuals</a></li>
</ul>
</li>
<li><a class="nav-link" href="#var-fitting"><span class="header-section-number">13.2</span> VAR fitting</a></li>
<li><a class="nav-link" href="#granger-causality-test"><span class="header-section-number">13.3</span> Granger causality test</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Time Series Analysis With R</strong>" was written by Nicola Righetti. It was last built on 2025-10-13.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
