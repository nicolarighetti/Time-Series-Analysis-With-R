<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>8 Correlations and ARIMA | Time Series Analysis With R</title>
<meta name="author" content="Nicola Righetti">
<meta name="generator" content="bookdown 0.43 with bs4_book()">
<meta property="og:title" content="8 Correlations and ARIMA | Time Series Analysis With R">
<meta property="og:type" content="book">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="8 Correlations and ARIMA | Time Series Analysis With R">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.8.0/transition.js"></script><script src="libs/bs3compat-0.8.0/tabs.js"></script><script src="libs/bs3compat-0.8.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
<meta name="description" content="8.1 Auto-Correlation (ACF and PACF) In the previous chapter we said that a time series is said to be stationary if there is: no trend (no systematic change in mean, that is, time invariant mean),...">
<meta property="og:description" content="8.1 Auto-Correlation (ACF and PACF) In the previous chapter we said that a time series is said to be stationary if there is: no trend (no systematic change in mean, that is, time invariant mean),...">
<meta name="twitter:description" content="8.1 Auto-Correlation (ACF and PACF) In the previous chapter we said that a time series is said to be stationary if there is: no trend (no systematic change in mean, that is, time invariant mean),...">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Time Series Analysis With R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Time Series Analysis With R</a></li>
<li><a class="" href="getting-started-with-r.html"><span class="header-section-number">2</span> Getting started with R</a></li>
<li><a class="" href="basic-data-wrangling-with-tidyverse.html"><span class="header-section-number">3</span> Basic Data Wrangling with Tidyverse</a></li>
<li><a class="" href="basic-concepts.html"><span class="header-section-number">4</span> Basic Concepts</a></li>
<li><a class="" href="time-series-objects.html"><span class="header-section-number">5</span> Time Series Objects</a></li>
<li><a class="" href="plot-time-series.html"><span class="header-section-number">6</span> Plot Time Series</a></li>
<li><a class="" href="structural-decomposition.html"><span class="header-section-number">7</span> Structural Decomposition</a></li>
<li><a class="active" href="correlations-and-arima.html"><span class="header-section-number">8</span> Correlations and ARIMA</a></li>
<li><a class="" href="regression.html"><span class="header-section-number">9</span> Regression</a></li>
<li><a class="" href="intervention-analysis.html"><span class="header-section-number">10</span> Intervention Analysis</a></li>
<li><a class="" href="interrupted-time-series-analysis-using-segmented-regression.html"><span class="header-section-number">11</span> Interrupted time series analysis using segmented regression</a></li>
<li><a class="" href="var.html"><span class="header-section-number">12</span> VAR</a></li>
<li><a class="" href="readings-and-bibliographical-references.html"><span class="header-section-number">13</span> Readings and Bibliographical References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="correlations-and-arima" class="section level1" number="8">
<h1>
<span class="header-section-number">8</span> Correlations and ARIMA<a class="anchor" aria-label="anchor" href="#correlations-and-arima"><i class="fas fa-link"></i></a>
</h1>
<div id="auto-correlation-acf-and-pacf" class="section level2" number="8.1">
<h2>
<span class="header-section-number">8.1</span> Auto-Correlation (ACF and PACF)<a class="anchor" aria-label="anchor" href="#auto-correlation-acf-and-pacf"><i class="fas fa-link"></i></a>
</h2>
<p>In the previous chapter we said that a time series is said to be stationary if there is:</p>
<ul>
<li>
<strong>no trend</strong> (no systematic change in mean, that is, time invariant mean), and no seasonality (no periodic variations);</li>
<li>
<strong>no change in variance</strong> over time (time invariant variance);</li>
<li>
<strong>no auto-correlation</strong> (we’ll return to this topic in the next chapters)</li>
</ul>
<p>Auto-correlation or serial correlation is an important characteristic of time series data and can be defined as the <em>correlation of a variable with itself at different time points</em>.</p>
<p>Autocorrelation has many consequences. It prevents us to use traditional statistical methods such as linear regression, which assume that the observations are independent from each other. In presence of autocorrelation, the estimated standard errors of the parameter estimates will tend to be less than their true value. This will lead to erroneously high statistical significance being attributed to statistical tests (the <em>p</em> values will be smaller than they should be).</p>
<p>In this section we introduce an important tool for the diagnosis of the properties of a time series, including autocorrelation: the <strong>correlogram</strong>. The accurate study of correlogram is a common step in many time series analysis procedures.</p>
<div id="correlogram-acf-and-pacf" class="section level3" number="8.1.1">
<h3>
<span class="header-section-number">8.1.1</span> Correlogram: ACF and PACF<a class="anchor" aria-label="anchor" href="#correlogram-acf-and-pacf"><i class="fas fa-link"></i></a>
</h3>
<p>The correlogram is a chart that presents one of two statistics:</p>
<ul>
<li>
<strong>the autocorrelation function (ACF)</strong>.The ACF statistic measures the correlation between <span class="math inline">\(x_t\)</span> and <span class="math inline">\(x_{t+k}\)</span> where <em>k</em> is the number of lead periods into the future. It measures the correlation between any two points based on a given interval. It is not strictly equivalent to the Pearson product moment correlation. In R, ACF is calculated and visualized with the function “acf”;</li>
<li>
<strong>the partial autocorrelation function (PACF)</strong>. The PACF(k) is a measure of correlation between times series observations that are k units apart, after the correlation at intermediate lags has been controlled for or “partialed” out. In other words, the PACF measures the correlation between <span class="math inline">\(x_t\)</span> and <span class="math inline">\(x_{t+k}\)</span> after it has stripped out the effect of the intermediate <em>x</em>’s. In R, the PACF is calculated and visualized with the function “pacf”. It is useful to detect correlations that are not evident in ACF.</li>
</ul>
<p>Let’s consider, as an example, the correlogram of a random walk process. We know that this is a particular time series process in which the current values are combinations of the previous ones (<span class="math inline">\(x_t = x_{t-1} + w_t\)</span>, where <span class="math inline">\(x_{t-1}\)</span> is the value immediately before x, and <span class="math inline">\(w_t\)</span> is a random component). The resulting time series is characterized by a discernible pattern over time which is not exactly predictable (<em>stochastic trend</em>). The ACF of a random walk time series, indeed, shows a correlation between values in the series: even values not so close are notwithstanding correlated.</p>
<div class="sourceCode" id="cb196"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Random_Walk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/arima.sim.html">arima.sim</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">499</span>, model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">acf</a></span><span class="op">(</span><span class="va">Random_Walk</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Time-Series-Analysis-With-R_files/figure-html/unnamed-chunk-135-1.png" width="672"></div>
<p>Instead, the PACF, which removes the correlations between intermediate values, shows a correlation at lag 1, that is, it shows that the overall correlation depends on consequent values. The dotted blue lines signal the boundaries of statistical significance.</p>
<div class="sourceCode" id="cb197"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">pacf</a></span><span class="op">(</span><span class="va">Random_Walk</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Time-Series-Analysis-With-R_files/figure-html/unnamed-chunk-136-1.png" width="672"></div>
<p>We can clearly visualize the auto-correlation by using a simple scatterplot, by plotting two consecutive lines of points.</p>
<div class="sourceCode" id="cb198"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">Random_Walk</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">499</span><span class="op">]</span>, <span class="va">Random_Walk</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">500</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Time-Series-Analysis-With-R_files/figure-html/unnamed-chunk-137-1.png" width="672"></div>
<p>The ACF or PACF of a white noise process is very different. We know that white noise is a stationary process, without distinguishable points in time and no correlation between points. Indeed, the ACF of white noise shows no correlation (the only line above statistical significance is at zero, which is nothing to be worried about, since it just means that each point is correlated with itself).</p>
<div class="sourceCode" id="cb199"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">White_Noise</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/arima.sim.html">arima.sim</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">500</span>, model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">acf</a></span><span class="op">(</span><span class="va">White_Noise</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Time-Series-Analysis-With-R_files/figure-html/unnamed-chunk-138-1.png" width="672"></div>
<p>In the PACF we can see that there is nothing above the dotted line (which means that there is nothing statistically significant).</p>
<div class="sourceCode" id="cb200"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">pacf</a></span><span class="op">(</span><span class="va">White_Noise</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Time-Series-Analysis-With-R_files/figure-html/unnamed-chunk-139-1.png" width="672"></div>
<p>If we plot two consecutive lists of points by using a scatterplot, we can see there is no serial correlation (no pattern is visible):</p>
<div class="sourceCode" id="cb201"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">White_Noise</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">499</span><span class="op">]</span>, <span class="va">White_Noise</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">500</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Time-Series-Analysis-With-R_files/figure-html/unnamed-chunk-140-1.png" width="672"></div>
</div>
</div>
<div id="arima-models" class="section level2" number="8.2">
<h2>
<span class="header-section-number">8.2</span> ARIMA models<a class="anchor" aria-label="anchor" href="#arima-models"><i class="fas fa-link"></i></a>
</h2>
<p>The ACF and PACF plots can be used to diagnose the main characteristics of a time series and find a proper statistical model. We talk about univariate models, since they are models to describe a single time series. Univariate time series can be modeled as <strong>Auto Regressive (AR), Integrated (I), and Moving Average (MA) processes</strong>. These models are synthesized using the acronym <strong>ARIMA</strong>. When a seasonal (S) component is also taken into account, we also use the acronym <em>SARIMA</em>.</p>
<div id="auto-regressive-ar-models" class="section level3" number="8.2.1">
<h3>
<span class="header-section-number">8.2.1</span> Auto Regressive (AR) models<a class="anchor" aria-label="anchor" href="#auto-regressive-ar-models"><i class="fas fa-link"></i></a>
</h3>
<p>We just said that a time series is often characterized by auto-correlation, so we can clearly deduce that we can model it by using a regression model, that is, by regressing the time series on its past values. In this way we have an <strong>auto-regressive model</strong>: a regression of <span class="math inline">\(x_{t}\)</span> on past terms <span class="math inline">\(x_{t-k}\)</span> from the same series.</p>
<p>In time series analysis, past terms <span class="math inline">\(x_{t-k}\)</span> from a same series are called <strong>lags</strong>. The lagged values of a time series are its delayed values, where the delay can be of an arbitrary amount of time <span class="math inline">\(k\)</span>. For instance, considering a simple series of 4 data points distributed from time <span class="math inline">\({t+0}\)</span> (first data point) to time <span class="math inline">\({t+3}\)</span> (last data point) <span class="math inline">\({x_{t+0}, x_{t+1}, x_{t+2}, x_{t+3}}\)</span>, the corresponding lagged series, assuming <span class="math inline">\(k=1\)</span>, is <span class="math inline">\({NA, x_{t+0}, x_{t+1}, x_{t+2}}\)</span>. Notice that the first data point is missing since there is no data point behind it, and the other data points are shifted one time point ahead.</p>
<p>An auto-regressive (AR) model can be described as follows (the <span class="math inline">\(\alpha\)</span> are coefficients, <span class="math inline">\(t\)</span> are time points, <span class="math inline">\(w\)</span> is a random component or white noise):</p>
<p><span class="math display">\[
{x_t} = \alpha x_{t-1} + \alpha x_{t-2} + \alpha x_{t-k} + {w_t}
\]</span></p>
<div class="sourceCode" id="cb202"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">AR_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/arima.sim.html">arima.sim</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">500</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, ar <span class="op">=</span> <span class="fl">0.90</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">AR_1</span>, main <span class="op">=</span> <span class="st">"AR(1)"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Time-Series-Analysis-With-R_files/figure-html/unnamed-chunk-141-1.png" width="672"></div>
<p>The ACF of an autoregressive process typically shows a slow and gradual decay in autocorrelation over time.</p>
<div class="sourceCode" id="cb203"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">acf</a></span><span class="op">(</span><span class="va">AR_1</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Time-Series-Analysis-With-R_files/figure-html/unnamed-chunk-142-1.png" width="672"></div>
<p>The PACF of an autoregressive process shows a peak in correspondence with the order of the model. In the case of an AR(1) the peak is at time 1.</p>
<div class="sourceCode" id="cb204"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">pacf</a></span><span class="op">(</span><span class="va">AR_1</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Time-Series-Analysis-With-R_files/figure-html/unnamed-chunk-143-1.png" width="672"></div>
<p>In the case of an AR(3) the peak is at time 1, 2, and 3.</p>
<div class="sourceCode" id="cb205"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">AR_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/arima.sim.html">arima.sim</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">500</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, ar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">AR_3</span>, main <span class="op">=</span> <span class="st">"AR(3)"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Time-Series-Analysis-With-R_files/figure-html/unnamed-chunk-144-1.png" width="672"></div>
<div class="sourceCode" id="cb206"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">pacf</a></span><span class="op">(</span><span class="va">AR_3</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Time-Series-Analysis-With-R_files/figure-html/unnamed-chunk-144-2.png" width="672"></div>
<p>Now we can see that the <strong>random walk</strong> process we have seen above is a particular case of auto-regressive model. In a random walk process, each value is the previous one plus a random part:</p>
<p><span class="math display">\[
x_t = x_{t-1} + w_t
\]</span></p>
<p>Thus each point <span class="math inline">\(x_t\)</span> is correlated with the previous one <span class="math inline">\(x_{t-k}\)</span> where the lag value <span class="math inline">\(k\)</span> is equal to 1 (<span class="math inline">\({k=1}\)</span>). Therefore, a random walk process is an auto-regressive model of <strong>order 1</strong>, since just 1 lag is taken into consideration in the auto-regressive model (and with <span class="math inline">\(\alpha = 1\)</span>). The order of an auto-regressive model is indicated by parenthesis, e.g.: <strong>AR(1)</strong>.</p>
<p>The AR process can have different characteristics (and different ACF and PACF) based on the parameters.</p>
</div>
<div id="moving-average-ma-models" class="section level3" number="8.2.2">
<h3>
<span class="header-section-number">8.2.2</span> Moving Average (MA) models<a class="anchor" aria-label="anchor" href="#moving-average-ma-models"><i class="fas fa-link"></i></a>
</h3>
<p>We already know Moving Average as a method to smooth time series and detect a trend. When referring to Moving Average as a process (MA), we refer to a process in which the values of the series are a function of a <strong>weighted average of past errors</strong>. In other terms, a moving average (MA) process is a linear combination of the current white noise term and the <span class="math inline">\(q\)</span> most recent past white noise terms:</p>
<p><span class="math display">\[
{x_t} = w_t + \beta w_{t-1} + ... + \beta w_{t-q}
\]</span></p>
<p>The order of a MA process indicates the lags of white noise taken into account in the model (e.g: <em>MA(3)</em>).</p>
<div class="sourceCode" id="cb207"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MA_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/arima.sim.html">arima.sim</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">500</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">3</span><span class="op">)</span>, ma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">MA_3</span>, main <span class="op">=</span> <span class="st">"MA(3)"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure">
<img src="Time-Series-Analysis-With-R_files/figure-html/unnamed-chunk-145-1.png" width="672">
The ACF plot of a MA process shows a more clear cut-off after the term corresponding to the order ot the process. It is different from the ACF of an AR process, which shows a more gradual decay.</div>
<div class="sourceCode" id="cb208"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">acf</a></span><span class="op">(</span><span class="va">MA_3</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Time-Series-Analysis-With-R_files/figure-html/unnamed-chunk-146-1.png" width="672"></div>
<p>The PACF of a MA process shows an up-and-down movement and does not shut off, but instead tapers toward 0 in some manner.</p>
<div class="sourceCode" id="cb209"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">pacf</a></span><span class="op">(</span><span class="va">MA_3</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Time-Series-Analysis-With-R_files/figure-html/unnamed-chunk-147-1.png" width="672"></div>
</div>
<div id="integrated-i-process" class="section level3" number="8.2.3">
<h3>
<span class="header-section-number">8.2.3</span> Integrated (I) process<a class="anchor" aria-label="anchor" href="#integrated-i-process"><i class="fas fa-link"></i></a>
</h3>
<p>An integrated process is a non-stationary time series process that becomes stationary when transformed by <strong>differencing</strong>. In other words, an integrated process is a difference-stationary process, that is a process with a stochastic trends (see the previous chapter).</p>
<div class="sourceCode" id="cb210"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">I_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/arima.sim.html">arima.sim</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">500</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">I_1</span>, main <span class="op">=</span> <span class="st">"I(1)"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Time-Series-Analysis-With-R_files/figure-html/unnamed-chunk-148-1.png" width="672"></div>
<div class="sourceCode" id="cb211"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">I_1</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"I(1) after 'differencing'"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Time-Series-Analysis-With-R_files/figure-html/unnamed-chunk-149-1.png" width="672"></div>
</div>
<div id="seasonal-s-models" class="section level3" number="8.2.4">
<h3>
<span class="header-section-number">8.2.4</span> Seasonal (S) models<a class="anchor" aria-label="anchor" href="#seasonal-s-models"><i class="fas fa-link"></i></a>
</h3>
<p>We already introduced the seasonal model. For instance, a dataset showing a seasonal component is AirPassengers. The seasonality appears in the yearly fluctuations in the ACF and in the spikes occurring at 12 months from each other in the PACF.</p>
<div class="sourceCode" id="cb212"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"AirPassengers"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># this function par(mfrow=c(..., ...))</span></span>
<span><span class="co"># is used to combine more than one plot</span></span>
<span><span class="co"># in the same frame. The two numerical values</span></span>
<span><span class="co"># indicates number of rows and columns</span></span>
<span><span class="co"># the frame is made of</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">acf</a></span><span class="op">(</span><span class="va">AirPassengers</span>, lag.max <span class="op">=</span> <span class="fl">48</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">pacf</a></span><span class="op">(</span><span class="va">AirPassengers</span>, lag.max <span class="op">=</span> <span class="fl">48</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Time-Series-Analysis-With-R_files/figure-html/unnamed-chunk-150-1.png" width="672"></div>
</div>
<div id="fit-sarima-models" class="section level3" number="8.2.5">
<h3>
<span class="header-section-number">8.2.5</span> Fit (S)ARIMA models<a class="anchor" aria-label="anchor" href="#fit-sarima-models"><i class="fas fa-link"></i></a>
</h3>
<p>The above examples represent simple processes, but real time series are often the result of more complex <strong>mixtures of different types of process</strong>, and therefore it is more complex to identify an appropriate model for the data.</p>
<div class="sourceCode" id="cb213"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">7623</span><span class="op">)</span></span>
<span><span class="va">arima_112</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/arima.sim.html">arima.sim</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">500</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, ar <span class="op">=</span> <span class="fl">0.8</span>, ma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">arima_112</span>, main <span class="op">=</span> <span class="st">"ARIMA(1,1,2)"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Time-Series-Analysis-With-R_files/figure-html/unnamed-chunk-151-1.png" width="672"></div>
<p>A popular methods to find the appropriate model is the <a href="https://en.wikipedia.org/wiki/Box%E2%80%93Jenkins_method">Box-Jenkins method</a>, a recursive process involving the analysis of a time series, the guess of possible (S)ARIMA models, the fit of the hypothesized models, and a meta-analysis to determine the best specification. Once a best-fitting model has been
found, the correlogram of the <strong>residuals</strong> should be verified as <strong>white noise</strong>.</p>
<p>The Box-Jenkins method could be time-consuming and requires some expertise. ACF/PACF can also become difficult to read in case of complex models, and their appropriate interpretation could require a lot of expertise as well. Fortunately, experts have developed <strong>automated methods</strong> that allow us to automatically found and fit an ARIMA model. This is the case of the <strong>auto.arima</strong> function implemented in the <strong>forecast</strong> package (a package for time series analysis and especially for forecasting, developed by <a href="https://scholar.google.com/citations?user=vamErfkAAAAJ&amp;hl=en&amp;oi=ao">Rob J. Hyndman</a>, professor of statistics and time series analysis expert).</p>
<div class="sourceCode" id="cb214"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install the package if you haven't installed it yet</span></span>
<span><span class="co"># install.packages("forecast")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://pkg.robjhyndman.com/forecast/">forecast</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">arima_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://pkg.robjhyndman.com/forecast/reference/auto.arima.html">auto.arima</a></span><span class="op">(</span><span class="va">arima_112</span><span class="op">)</span></span>
<span></span>
<span><span class="va">arima_fit</span></span></code></pre></div>
<pre><code>## Series: arima_112 
## ARIMA(1,1,2) 
## 
## Coefficients:
##          ar1     ma1     ma2
##       0.7649  0.7387  0.2484
## s.e.  0.0356  0.0528  0.0534
## 
## sigma^2 = 1.035:  log likelihood = -717.9
## AIC=1443.8   AICc=1443.88   BIC=1460.65</code></pre>
<p>As said above, to evaluate the fit of a model we should analyze the <strong>residuals</strong>, and ascertain they behave as white noise. The object resulting from the function <em>auto.arima</em> has a slot including the residuals. To ascertain that residuals are white noise we can plot its <strong>ACF and PACF</strong> (no spike should be significant) and also its <strong>histogram</strong>.</p>
<div class="sourceCode" id="cb216"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/layout.html">layout</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">acf</a></span><span class="op">(</span><span class="va">arima_fit</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">pacf</a></span><span class="op">(</span><span class="va">arima_fit</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">arima_fit</span><span class="op">$</span><span class="va">residuals</span>, main <span class="op">=</span> <span class="st">"Histogram of residuals"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Time-Series-Analysis-With-R_files/figure-html/unnamed-chunk-153-1.png" width="672"></div>
<p>The <em>forecast</em> package also implements the function <strong>checkresiduals</strong> to create nice and complete plots of residual diagnostics by using a simple function.</p>
<p>Besides creating the plots, the function calulate the <strong>Ljung-Box test</strong> (default), or the <strong>Breusch-Godfrey test</strong> (if you specify <em>test=“BG”</em> inside the function):</p>
<p>The <em>Ljung-Box test</em> (and also the Breusch–Godfrey test) is a diagnostic tool, applied to the residuals of a time series after fitting an ARIMA model, to test the lack of fit. The test examines the autocorrelations of the residuals. If there are no significant autocorrelations, it can be concluded that the model does not exhibit significant lack of fit. To pass the test, the p-value has to be above the significance level (usually 0.05)</p>
<div class="sourceCode" id="cb217"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://pkg.robjhyndman.com/forecast/reference/checkresiduals.html">checkresiduals</a></span><span class="op">(</span><span class="va">arima_fit</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Time-Series-Analysis-With-R_files/figure-html/unnamed-chunk-154-1.png" width="672"></div>
<pre><code>## 
##  Ljung-Box test
## 
## data:  Residuals from ARIMA(1,1,2)
## Q* = 5.8977, df = 7, p-value = 0.5517
## 
## Model df: 3.   Total lags used: 10</code></pre>
<div id="sarima" class="section level4" number="8.2.5.1">
<h4>
<span class="header-section-number">8.2.5.1</span> SARIMA<a class="anchor" aria-label="anchor" href="#sarima"><i class="fas fa-link"></i></a>
</h4>
<p>If we fit a model to the <em>AirPassengers</em> dataset, which has a seasonal component, we find a Seasonal Autoregressive Integrated Moving Average model (<strong>SARIMA</strong>). The seasonal component of the AirPassenger dataset is evident in the plot of the series and its ACF and PACF. The <em>forecast</em> package has a useful function <strong>ggtsdisplay</strong> to plot a time series along with its ACF and PACF.</p>
<div class="sourceCode" id="cb219"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://pkg.robjhyndman.com/forecast/reference/tsdisplay.html">ggtsdisplay</a></span><span class="op">(</span><span class="va">AirPassengers</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Time-Series-Analysis-With-R_files/figure-html/unnamed-chunk-155-1.png" width="672"></div>
<p>The seasonal part of the ARIMA model consists of terms that are similar to the non-seasonal components of the model, but involves lagged values of the seasonal period.</p>
<div class="sourceCode" id="cb220"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">AirPassengers_sarima</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://pkg.robjhyndman.com/forecast/reference/auto.arima.html">auto.arima</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/window.html">window</a></span><span class="op">(</span><span class="va">AirPassengers</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">AirPassengers_sarima</span></span></code></pre></div>
<pre><code>## Series: window(AirPassengers) 
## ARIMA(2,1,1)(0,1,0)[12] 
## 
## Coefficients:
##          ar1     ar2      ma1
##       0.5960  0.2143  -0.9819
## s.e.  0.0888  0.0880   0.0292
## 
## sigma^2 = 132.3:  log likelihood = -504.92
## AIC=1017.85   AICc=1018.17   BIC=1029.35</code></pre>
</div>
<div id="forecasting" class="section level4" number="8.2.5.2">
<h4>
<span class="header-section-number">8.2.5.2</span> Forecasting<a class="anchor" aria-label="anchor" href="#forecasting"><i class="fas fa-link"></i></a>
</h4>
<p>Based on the ARIMA models we found, we can also try to <strong>forecast</strong> future values. We can use the function <strong>forecast</strong> of the homonym library. For instance, we could try to forecast the values of the AirPassenger dataset in the next four years.</p>
<div class="sourceCode" id="cb222"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">AirPassengers_forecast</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/forecast.html">forecast</a></span><span class="op">(</span><span class="va">AirPassengers_sarima</span>, h<span class="op">=</span><span class="fl">48</span>, level <span class="op">=</span> <span class="fl">90</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">AirPassengers_forecast</span>, main <span class="op">=</span> <span class="st">"AirPassengers forecast"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Time-Series-Analysis-With-R_files/figure-html/unnamed-chunk-157-1.png" width="672"></div>
<div class="sourceCode" id="cb223"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">AirPassengers_sarima</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://pkg.robjhyndman.com/forecast/reference/auto.arima.html">auto.arima</a></span><span class="op">(</span><span class="va">AirPassengers</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div id="cross-correlation" class="section level2" number="8.3">
<h2>
<span class="header-section-number">8.3</span> Cross-correlation<a class="anchor" aria-label="anchor" href="#cross-correlation"><i class="fas fa-link"></i></a>
</h2>
<p><em>Cross-correlation </em>is the correlation between the (lagged) values of a time series and the values of another series. Similarly to ACF and PACF, there is a specific plot that shows the cross-correlation between two time series, and a specific R function: <strong>ccf</strong>.</p>
<p>The cross-correlation can be useful to understand wich lagged values of a <em>X</em> series can be used to predict the values of a <em>Y</em> series, and thus used, for instance, in a time series regression model.</p>
<p>Unfourtunately, the problem with the cross-correlation function is that, as we said in the preceding sections, with autocorrelated data it is difficult to assess the dependence between two processes, and it is possible to find spurious correlations.</p>
<p>Thus, it is pertinent to disentangle the linear association between <em>X</em> and <em>Y</em> from their autocorrelation. A useful device for doing this is <strong>prewhitening</strong>. The prewhitening method works as follows:</p>
<ol style="list-style-type: decimal">
<li>determine an ARIMA <em>time series model</em> for the X-variable, and store the residuals from this model;</li>
<li>fit the ARIMA X-model to the Y-variable, and keep the residuals;</li>
<li>examines the CCF between the X and Y model residuals.</li>
</ol>
<p>We can implement this procedure writing all the necessary code, or by using the library <em>forecast</em>, or also, alternatively, the library <em>TSA</em>.</p>
<p>To make an example, we apply the method to two simulated two series. The Y-variable is created in such a way that it is correlated with the lagged values at time <span class="math inline">\(x_{t-3}\)</span> and <span class="math inline">\(x_{t-4}\)</span>. Therefore, we should find a correlation at those lags.</p>
<div class="sourceCode" id="cb224"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x_series</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/arima.sim.html">arima.sim</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">200</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>, ar <span class="op">=</span> <span class="fl">0.7</span>, sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.union.html">ts.intersect</a></span><span class="op">(</span><span class="va">x_series</span>, <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span><span class="op">(</span><span class="va">x_series</span>, <span class="op">-</span><span class="fl">3</span><span class="op">)</span>, <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span><span class="op">(</span><span class="va">x_series</span>, <span class="op">-</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">y_series</span> <span class="op">&lt;-</span> <span class="fl">15</span> <span class="op">+</span> <span class="fl">0.8</span><span class="op">*</span><span class="va">z</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="fl">1.5</span><span class="op">*</span><span class="va">z</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">197</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>The cross-correlation applied to the original series results in a plot where everything seems to be correlated. The “real” correlation at <span class="math inline">\(x_{t-3}\)</span> and <span class="math inline">\(x_{t-4}\)</span> is not discernible at all.</p>
<div class="sourceCode" id="cb225"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">ccf</a></span><span class="op">(</span><span class="va">x_series</span>, <span class="va">y_series</span>, na.action <span class="op">=</span> <span class="va">na.omit</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Time-Series-Analysis-With-R_files/figure-html/unnamed-chunk-159-1.png" width="672"></div>
<p>By using the <em>forecast</em> library, we can calculate the pre-withened <em>ccf</em> as follows:</p>
<div class="sourceCode" id="cb226"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># fit an ARIMA model</span></span>
<span><span class="va">x_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://pkg.robjhyndman.com/forecast/reference/auto.arima.html">auto.arima</a></span><span class="op">(</span><span class="va">x_series</span><span class="op">)</span></span>
<span><span class="co"># keep the residuals ("white noise")</span></span>
<span><span class="va">x_residuals</span> <span class="op">&lt;-</span> <span class="va">x_model</span><span class="op">$</span><span class="va">residuals</span></span>
<span></span>
<span><span class="co"># fit the same ARIMA model to the Y-series</span></span>
<span><span class="co"># by using the "Arima" function in forecast</span></span>
<span><span class="va">y_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://pkg.robjhyndman.com/forecast/reference/Arima.html">Arima</a></span><span class="op">(</span><span class="va">y_series</span>, model<span class="op">=</span><span class="va">x_model</span><span class="op">)</span></span>
<span><span class="co"># keep the residuals</span></span>
<span><span class="va">y_filtered</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">y_model</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># apply the ccf to the residuals</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">ccf</a></span><span class="op">(</span><span class="va">x_residuals</span>, <span class="va">y_filtered</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Time-Series-Analysis-With-R_files/figure-html/unnamed-chunk-160-1.png" width="672"></div>
<p>Now, it’s clear that the X-variable is correlated with the Y-variable at <span class="math inline">\(x_{t-3}\)</span> and <span class="math inline">\(x_{t-4}\)</span>.</p>
<p>The previous steps show in some detail the steps involved in the pre-whitening strategy, but it is possible to use the original series with the <strong>prewhiten</strong> function of the <strong>TSA</strong> library. Although the function can take, as an argument, a pre-fitted ARIMA model, its greater advantage is that it can take care of all the necessary steps to prewithen the series. In particular, if no model is specified, the library automatically applies a simple AR model. Although this model can be just an approximation of the “true” model (which can be more complex), an approximation can be enough to pre-whiten the series and find a proper cross-correlation (that is, also a simpler and approximate model can do the job).</p>
<div class="sourceCode" id="cb227"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("TSA")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://stat.uiowa.edu/~kchan/TSA.htm">TSA</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TSA/man/prewhiten.html">prewhiten</a></span><span class="op">(</span><span class="va">x_series</span>, <span class="va">y_series</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Time-Series-Analysis-With-R_files/figure-html/unnamed-chunk-161-1.png" width="672"></div>
</div>
<div id="examples-in-literature" class="section level2" number="8.4">
<h2>
<span class="header-section-number">8.4</span> Examples in literature<a class="anchor" aria-label="anchor" href="#examples-in-literature"><i class="fas fa-link"></i></a>
</h2>
<p>A few examples to exemplify the use of ARIMA and Cross-Correlation in the scientific literature, with specific reference to communication science.</p>
<p>In <a href="https://academic.oup.com/joc/article/61/1/48/4098436?casa_token=b3Cd_02sN9IAAAAA:MM9rnMjb14X1ZSqxrcswoO3CDEYHry97L9EG9vL4dt5kpkZryx8VSlR8F_wXaOmBBu9VZvqlrLCZ0w">Scheufele, B., Haas, A., &amp; Brosius, H. B. (2011). Mirror or molder? A study of media coverage, stock prices, and trading volumes in Germany. Journal of Communication, 61(1), 48-70</a>, the authors investigate <em>“the short-term relationship between media coverage, stock prices, and trading volumes of eight listed German companies”</em>, by using ARIMA and cross-correlation, in particular asking:</p>
<blockquote>
<p>RQ2: Do cross-lagged correlations between media coverage and stock prices or trading volumes differ according to the amount and the valence of coverage?
RQ3: Do cross-lagged correlations between media coverage and stock prices or trading volumes differ according to the type of media (Financial Web sites, daily newspapers, and stock market TV shows) which reports on the company or stock?</p>
</blockquote>
<p>To answer these questions, the authors made use of time series analysis. In particular, they:</p>
<blockquote>
<p>estimated cross-lagged correlations between media coverage and stock prices or trading volumes, respectively. Basically, two steps of time-series analysis can be distinguished: (a) In the first step, each media time-series and each time-series of trading volumes was adjusted by ARIMA (Autoregressive Integrated Moving Average) modeling separately. The differences between the original time-series and its ARIMA model are called residuals and were used for analysis. Like with ordinary least squares regression, these residuals should not be auto-correlated. If the residuals are not auto-correlated, time-series analysis speaks of White Noise. This modeling technique called prewhitening was necessary to avoid spurious correlations. (…) (b) In the next step, cross-correlations between each adjusted media time-series and each adjusted stock series were calculated. (…) The coefficient expresses the strength of correlation, whereas the lags offer an insight into dynamics: Correlations at positive (negative) lags indicate that changes in media coverage proceeded (succeeded) shifts in stock prices or trading volumes.</p>
</blockquote>
<p>In <a href="https://ijoc.org/index.php/ijoc/article/viewFile/495/392">Groshek, J. (2010). A time-series, multinational analysis of democratic forecasts and Internet diffusion. International Journal of Communication, 4, 33</a>, the author <em>examines the democratic effects that the Internet has shown using macro- level, cross-national data in a sequence of time–series statistical tests</em>:</p>
<blockquote>
<p>this study relies principally on macro-level time–series democracy data from an historical sample that includes 72 countries, reaching back as far as 1946 in some cases, but at least from 1954 to 2003. From this sample, a sequence of ARIMA (autoregressive integrated moving average) time–series regressions were modeled for each country for at least 40 years prior to 1994. These models were then used to generate statistically-forecasted democracy values for each country, in each year from 1994 to 2003. A 95% confidence interval with an upper and lower democracy score was then constructed around each of the forecasted values using dynamic mean squared errors. The actual democracy scores of each country for each year from 1994 to 2003 were then compared to the upper and lower values of the confidence interval.
In the event that the actual democracy level of any country was greater than the upper value of the forecasted democracy score during the time period of 1994 to 2003, Internet diffusion was investigated in case studies as a possible causal mechanism.</p>
</blockquote>
<p>In other terms, the author used a forecasting approach to predict the values of the series from 1994 to 2003, in order to find statistically significant differences between the predicted and the actual values. These discrepancies were interpreted as caused by factors that were not present in the past, and possibly by the introduction of the Internet.</p>
<p>The study found that, <em>based on the results of the 72 countries reported here, the diffusion of the Internet should not be considered a democratic panacea, but rather a component of contemporary democratization processes</em></p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="structural-decomposition.html"><span class="header-section-number">7</span> Structural Decomposition</a></div>
<div class="next"><a href="regression.html"><span class="header-section-number">9</span> Regression</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#correlations-and-arima"><span class="header-section-number">8</span> Correlations and ARIMA</a></li>
<li>
<a class="nav-link" href="#auto-correlation-acf-and-pacf"><span class="header-section-number">8.1</span> Auto-Correlation (ACF and PACF)</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#correlogram-acf-and-pacf"><span class="header-section-number">8.1.1</span> Correlogram: ACF and PACF</a></li></ul>
</li>
<li>
<a class="nav-link" href="#arima-models"><span class="header-section-number">8.2</span> ARIMA models</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#auto-regressive-ar-models"><span class="header-section-number">8.2.1</span> Auto Regressive (AR) models</a></li>
<li><a class="nav-link" href="#moving-average-ma-models"><span class="header-section-number">8.2.2</span> Moving Average (MA) models</a></li>
<li><a class="nav-link" href="#integrated-i-process"><span class="header-section-number">8.2.3</span> Integrated (I) process</a></li>
<li><a class="nav-link" href="#seasonal-s-models"><span class="header-section-number">8.2.4</span> Seasonal (S) models</a></li>
<li><a class="nav-link" href="#fit-sarima-models"><span class="header-section-number">8.2.5</span> Fit (S)ARIMA models</a></li>
</ul>
</li>
<li><a class="nav-link" href="#cross-correlation"><span class="header-section-number">8.3</span> Cross-correlation</a></li>
<li><a class="nav-link" href="#examples-in-literature"><span class="header-section-number">8.4</span> Examples in literature</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Time Series Analysis With R</strong>" was written by Nicola Righetti. It was last built on 2025-10-12.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
